# 作业二 - 遍历目录

## 要求

- 编程实现程序list.c，列表普通磁盘文件，包括文件名和文件大小。
- 使用vi编辑文件，熟悉工具vi。
- 使用Linux的系统调用和库函数。
- 体会Shell文件通配符的处理方式以及命令对选项的处理方式。
- （对选项的处理，自行编程逐个分析命令行参数。不考虑多选项挤在一个命令行参数内的情况）

处理对象：
- 与ls命令类似，处理对象可以有0到多个
- 0个：列出当前目录下所有文件
- 普通文件：列出文件
- 目录：列出目录下所有文件

实现自定义选项r,a,l,h,m以及--
- r 递归方式列出子目录（每项要含路径，类似find的-print输出风格，需要设计递归程序）
- a 列出文件名第一个字符为圆点的普通文件（默认情况下不列出文件名首字符为圆点的文件）
- l 后跟一整数，限定文件大小的最小值（字节）
- h 后跟一整数，限定文件大小的最大值（字节）
- m 后跟一整数n，限定文件的最近修改时间必须在n天内
- --显式地终止命令选项分析

## 提示与实例

编辑，编译
- `vi list.c`
- `make list` 或者 `gcc list.c –o list`

运行举例
- ./list –l 100 –h 5000 /bin /etc列出大小在100~5000之间的文件
- ./list –a -r -l 50000 –m 2 递归式列出当前目录树下大小超50KB且2天内修改过的文件（包括文件名首字符为圆点的文件）
- ./list ---l
- ./list *

## 延伸学习

用于处理命令选项的库函数getopt_long，用这个函数重新设计选项处理部分，设计长短格式选项。体会这个库函数功能的设计思想

## 参考函数

```c
#include <stdio.h>
#include <dirent.h>
#include <sys/stat.h>

/* 获取路径名path对应的i节点中的属性*/
struct stat st;

ret =stat(path,&st);

/* 判断i节点属性为目录*/
if(S_ISDIR(st.st_mode)){
	...
}
```